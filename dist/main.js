(()=>{"use strict";function t(l){if(1===l.length)return l;{const e=Math.ceil(l.length/2);let r=t(l.slice(0,e)),i=t(l.slice(e)),n=[];for(;r[0]||i[0];)r[0]<i[0]?(n.push(r[0]),r.shift()):i[0]<r[0]?(n.push(i[0]),i.shift()):r[0]==i[0]?(n.push(r[0]),n.push(i[0]),r.shift(),i.shift()):r[0]?i[0]||(n.push(r[0]),r.shift()):(n.push(i[0]),i.shift());return n}}class l{constructor(t){this.data=t,this.left=null,this.right=null}}function e(t){if(0===t.length)return null;{const r=Math.floor(t.length/2),i=new l(t[r]);return i.left=e(t.slice(0,r)),i.right=e(t.slice(r+1)),i}}const r=(t,l="",e=!0)=>{null!==t&&(null!==t.right&&r(t.right,`${l}${e?"│   ":"    "}`,!1),console.log(`${l}${e?"└── ":"┌── "}${t.data}`),null!==t.left&&r(t.left,`${l}${e?"    ":"│   "}`,!0))};let i=new class{constructor(l){this.root=function(l){let r=t(l);return e([...new Set(r)])}(l)}insert(t){!function t(e,r){if(r<e.data&&null==e.left){const t=new l(r);e.left=t}else if(r>e.data&&null==e.right){const t=new l(r);e.right=t}else{if(r<e.data)return t(e.left,r);if(r>e.data)return t(e.right,r);if(r==e.data)return void console.log("value already in tree, try another value")}}(this.root,t)}delete(t){!function t(l,e){if(l.left&&l.left.data===e&&null===l.left.left&&null===l.left.right)l.left=null;else if(l.right&&l.right.data===e&&null===l.right.left&&null===l.right.right)l.right=null;else if(l.left&&l.left.data===e&&null!==l.left.left&&null===l.left.left.left&&null===l.left.left.right&&null===l.left.right)l.left=l.left.left;else if(l.left&&l.left.data===e&&null!==l.left.right&&null===l.left.right.left&&null===l.left.right.right&&null===l.left.left)l.left=l.left.right;else if(l.right&&l.right.data===e&&null!==l.right.left&&null===l.right.left.left&&null===l.right.left.right&&null===l.right.right)l.right=l.right.left;else if(l.right&&l.right.data===e&&null!==l.right.right&&null===l.right.right.left&&null===l.right.right.right&&null===l.right.left)l.right=l.right.right;else if(l.data===e&&null!==l.left&&null!==l.right){let t=l.right,e=t;for(;null!==t.left;)e=t,t=t.left;l.data=t.data,e.left=null}else{if(e>l.data&&null===l.right)return void console.log(`${e} not found, please try again`);if(e<l.data&&null===l.left)return void console.log(`${e} not found, please try again`);if(e<l.data)return t(l.left,e);if(e>l.data)return t(l.right,e)}}(this.root,t)}find(t){!function t(l,e){if(l.data===e)return console.log(l),l;if(e>l.data&&null===l.right)console.log(`${e} not found`);else{if(!(e<l.data&&null===l.left))return e>l.data?t(l.right,e):e<l.data?t(l.left,e):void 0;console.log(`${e} not found`)}}(this.root,t)}levelOrderRecursive(t){}levelOrderIterative(t){let l=[];for(l.push(this.root);0!==l.length;)t(l[0]),l[0].left&&l.push(l[0].left),l[0].right&&l.push(l[0].right),l.shift()}preOrder(t){if(t){function l(e){t(e),null===e.left&&null===e.right||(e.left&&l(e.left),e.right&&l(e.right))}l(this.root)}else{function e(t){let l=[t.data];return null===t.left&&null===t.right?[t.data]:(t.left&&(l=l.concat(e(t.left))),t.right&&(l=l.concat(e(t.right))),l)}console.log(e(this.root))}}inOrder(t){if(t){function l(e){null!==e.left||null!==e.right?(e.left&&l(e.left),t(e),e.right&&l(e.right)):t(e)}l(this.root)}else{function e(t){let l=[];return t.left&&(l=l.concat(e(t.left))),l=l.concat([t.data]),t.right&&(l=l.concat(e(t.right))),l}console.log(e(this.root))}}}([1,7,4,23,8,9,4,3,5,7,9,67,6345,324]);i.insert(9),i.delete(323),r(i.root),i.find(6),i.find(1),i.preOrder(),i.preOrder((t=>console.log(t.data))),i.inOrder()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TSxFQUFLUCxNQUNMaUIsRUFBa0JWLEVBQUtQLE1BRTNCdUIsRUFBZWhCLEdBQ1hBLEVBQUtOLE9BQ0xnQixFQUFrQlYsRUFBS04sUUFUM0JzQixFQUFlaEIsRUFZdkIsQ0FDQVUsRUFBa0JuQixLQUFLTyxLQUMzQixLQUFPLENBQ0gsU0FBU1ksRUFBa0JWLEdBQ3ZCLElBQUlvQixFQUFpQixHQUlqQixPQUhJcEIsRUFBS1AsT0FBTTJCLEVBQWlCQSxFQUFlQyxPQUFPWCxFQUFrQlYsRUFBS1AsUUFDN0UyQixFQUFpQkEsRUFBZUMsT0FBTyxDQUFDckIsRUFBS1IsT0FDekNRLEVBQUtOLFFBQU8wQixFQUFpQkEsRUFBZUMsT0FBT1gsRUFBa0JWLEVBQUtOLFNBQ3ZFMEIsQ0FDZixDQUNBakIsUUFBUUMsSUFBSU0sRUFBa0JuQixLQUFLTyxNQUN2QyxDQUVKLEdFck9jLENBQUMsRUFBRyxFQUFHLEVBQUcsR0FBSSxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEdBQUksS0FBTSxNQU8vRE8sRUFBUUksT0FBTyxHQUdmSixFQUFRa0IsT0FBTyxLQUNmeEIsRUFBWU0sRUFBUVAsTUFFcEJPLEVBQVFTLEtBQUssR0FDYlQsRUFBUVMsS0FBSyxHQUliVCxFQUFRYyxXQUVSZCxFQUFRYyxVQUFVbkIsR0FBUUcsUUFBUUMsSUFBSUosRUFBS1IsUUFFM0NhLEVBQVFpQixTIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9wLWJhbGFuY2VkLWJpbmFyeS1zZWFyY2gtdHJlZS8uL3NyYy9tZXJnZVNvcnQuanMiLCJ3ZWJwYWNrOi8vdG9wLWJhbGFuY2VkLWJpbmFyeS1zZWFyY2gtdHJlZS8uL3NyYy9iaW5hcnlTZWFyY2hUcmVlLmpzIiwid2VicGFjazovL3RvcC1iYWxhbmNlZC1iaW5hcnktc2VhcmNoLXRyZWUvLi9zcmMvcHJldHR5UHJpbnQuanMiLCJ3ZWJwYWNrOi8vdG9wLWJhbGFuY2VkLWJpbmFyeS1zZWFyY2gtdHJlZS8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gbWVyZ2VTb3J0KGFycmF5KSB7XG4gICAgaWYgKGFycmF5Lmxlbmd0aCA9PT0gMSkgcmV0dXJuIGFycmF5O1xuICAgIGVsc2Uge1xuICAgICAgICBjb25zdCBoYWxmID0gTWF0aC5jZWlsKGFycmF5Lmxlbmd0aC8yKVxuICAgICAgICAvLyBzcGxpdCBhcnJheSBpbiBoYWxmXG4gICAgICAgIGNvbnN0IGxlZnRIYWxmID0gYXJyYXkuc2xpY2UoMCwgaGFsZilcbiAgICAgICAgLy8gY2FsbCBtZXJnZVNvcnQgb24gdGhlIGxlZnQgaGFsZlxuICAgICAgICBsZXQgc29ydGVkTGVmdEhhbGYgPSBtZXJnZVNvcnQobGVmdEhhbGYpXG5cbiAgICAgICAgY29uc3QgcmlnaHRIYWxmID0gYXJyYXkuc2xpY2UoaGFsZilcbiAgICAgICAgLy8gY2FsbCBtZXJnZVNvcnQgb24gdGhlIHJpZ2h0IGhhbGZcbiAgICAgICAgbGV0IHNvcnRlZFJpZ2h0SGFsZiA9IG1lcmdlU29ydChyaWdodEhhbGYpO1xuXG4gICAgICAgIC8vZm9yIGVhY2ggZWxlbWVudCBpbiBsZWZ0IGhhbGYgYW5kIHJpZ2h0IGhhbGYsIHNlZSB3aGljaCBpcyBzbWFsbGVyXG4gICAgICAgIGxldCBtZXJnZWRBcnJheSA9IFtdO1xuICAgICAgICB3aGlsZSAoc29ydGVkTGVmdEhhbGZbMF0gfHwgc29ydGVkUmlnaHRIYWxmWzBdKSB7XG4gICAgICAgICAgICBpZiAoc29ydGVkTGVmdEhhbGZbMF0gPCBzb3J0ZWRSaWdodEhhbGZbMF0pIHtcbiAgICAgICAgICAgICAgICBtZXJnZWRBcnJheS5wdXNoKHNvcnRlZExlZnRIYWxmWzBdKVxuICAgICAgICAgICAgICAgIHNvcnRlZExlZnRIYWxmLnNoaWZ0KClcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc29ydGVkUmlnaHRIYWxmWzBdIDwgc29ydGVkTGVmdEhhbGZbMF0pIHtcbiAgICAgICAgICAgICAgICBtZXJnZWRBcnJheS5wdXNoKHNvcnRlZFJpZ2h0SGFsZlswXSlcbiAgICAgICAgICAgICAgICBzb3J0ZWRSaWdodEhhbGYuc2hpZnQoKVxuXG4gICAgICAgICAgICAgICAgLy8gZWRnZSBjYXNlIHdoZXJlIHRoZSBzYW1lIG51bWJlciBpcyBiZWluZyBjb21wYXJlZFxuICAgICAgICAgICAgfSBlbHNlIGlmIChzb3J0ZWRMZWZ0SGFsZlswXSA9PSBzb3J0ZWRSaWdodEhhbGZbMF0pIHtcbiAgICAgICAgICAgICAgICBtZXJnZWRBcnJheS5wdXNoKHNvcnRlZExlZnRIYWxmWzBdKVxuICAgICAgICAgICAgICAgIG1lcmdlZEFycmF5LnB1c2goc29ydGVkUmlnaHRIYWxmWzBdKVxuICAgICAgICAgICAgICAgIHNvcnRlZExlZnRIYWxmLnNoaWZ0KClcbiAgICAgICAgICAgICAgICBzb3J0ZWRSaWdodEhhbGYuc2hpZnQoKVxuICAgICAgICAgICAgICAgIC8vIGVkZ2UgY2FzZSB3aGVyZSBvbmUgYXJyYXkgaXMgZW1wdHlcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXNvcnRlZExlZnRIYWxmWzBdKSB7XG4gICAgICAgICAgICAgICAgbWVyZ2VkQXJyYXkucHVzaChzb3J0ZWRSaWdodEhhbGZbMF0pXG4gICAgICAgICAgICAgICAgc29ydGVkUmlnaHRIYWxmLnNoaWZ0KClcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXNvcnRlZFJpZ2h0SGFsZlswXSkge1xuICAgICAgICAgICAgICAgIG1lcmdlZEFycmF5LnB1c2goc29ydGVkTGVmdEhhbGZbMF0pXG4gICAgICAgICAgICAgICAgc29ydGVkTGVmdEhhbGYuc2hpZnQoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWVyZ2VkQXJyYXk7XG4gICAgfVxufSIsImltcG9ydCB7IG1lcmdlU29ydCB9IGZyb20gXCIuL21lcmdlU29ydFwiO1xuXG5pbXBvcnQgeyBwcmV0dHlQcmludCB9IGZyb20gXCIuL3ByZXR0eVByaW50XCI7XG5cbmNsYXNzIE5vZGUge1xuICAgIGNvbnN0cnVjdG9yKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuZGF0YT0gdmFsdWU7XG4gICAgICAgIHRoaXMubGVmdCA9IG51bGw7XG4gICAgICAgIHRoaXMucmlnaHQgPSBudWxsO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBUcmVlIHtcbiAgICBjb25zdHJ1Y3RvcihhcnJheSkge1xuICAgICAgICB0aGlzLnJvb3QgPSBidWlsZFRyZWUoYXJyYXkpO1xuICAgIH1cblxuXG4gICAgaW5zZXJ0KHZhbHVlKSB7XG4gICAgICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUsIHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUgPCBub2RlLmRhdGEgJiYgbm9kZS5sZWZ0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdOb2RlID0gbmV3IE5vZGUodmFsdWUpO1xuICAgICAgICAgICAgICAgIG5vZGUubGVmdCA9IG5ld05vZGU7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPiBub2RlLmRhdGEgJiYgbm9kZS5yaWdodCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3Tm9kZSA9IG5ldyBOb2RlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBub2RlLnJpZ2h0ID0gbmV3Tm9kZTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA8IG5vZGUuZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWN1cnNpdmVGdW5jdGlvbihub2RlLmxlZnQsIHZhbHVlKVxuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID4gbm9kZS5kYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUucmlnaHQsIHZhbHVlKVxuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09IG5vZGUuZGF0YSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidmFsdWUgYWxyZWFkeSBpbiB0cmVlLCB0cnkgYW5vdGhlciB2YWx1ZVwiKVxuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJlY3Vyc2l2ZUZ1bmN0aW9uKHRoaXMucm9vdCwgdmFsdWUpXG4gICAgfVxuXG4gICAgZGVsZXRlKHZhbHVlKSB7XG4gICAgICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUsIHZhbHVlKSB7XG4gICAgICAgICAgICAvLyB0aGlzIGNvZGUgcmVxdWlyZXMgZ3VhcmQgY2xhdXNlOiBpZihub2RlLmxlZnQpLCBvciBpZihub2RlLnJpZ2h0KVxuICAgICAgICAgICAgLy8gY29uc2lkZXIgYXQgbGVhc3QgNCBjYXNlc1xuICAgICAgICAgICAgLy8gQ2FzZSAxOiBkZWxldGluZyB0aGUgbGVhZiBub2RlXG4gICAgICAgICAgICBpZiAobm9kZS5sZWZ0ICYmIG5vZGUubGVmdC5kYXRhID09PSB2YWx1ZSAmJiBub2RlLmxlZnQubGVmdCA9PT0gbnVsbCAmJiBub2RlLmxlZnQucmlnaHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBub2RlLmxlZnQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobm9kZS5yaWdodCAmJiBub2RlLnJpZ2h0LmRhdGEgPT09IHZhbHVlICYmIG5vZGUucmlnaHQubGVmdCA9PT0gbnVsbCAmJiBub2RlLnJpZ2h0LnJpZ2h0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5yaWdodCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBDYXNlIDI6IGRlbGV0aW5nIGEgYnJhbmNoIG5vZGUgd2l0aCBvbmUgbGVhZjsgcG9pbnQgdGhlIHByZWNlZGluZyBjaGlsZCB0byB0aGUgMm5kIGZvbGxvd2luZyBjaGlsZFxuICAgICAgICAgICAgZWxzZSBpZiAobm9kZS5sZWZ0ICYmIG5vZGUubGVmdC5kYXRhID09PSB2YWx1ZSAmJiBub2RlLmxlZnQubGVmdCAhPT0gbnVsbCAmJiBub2RlLmxlZnQubGVmdC5sZWZ0ID09PSBudWxsIFxuICAgICAgICAgICAgICAgICYmIG5vZGUubGVmdC5sZWZ0LnJpZ2h0ID09PSBudWxsICYmIG5vZGUubGVmdC5yaWdodCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBub2RlLmxlZnQgPSBub2RlLmxlZnQubGVmdFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobm9kZS5sZWZ0ICYmIG5vZGUubGVmdC5kYXRhID09PSB2YWx1ZSAmJiBub2RlLmxlZnQucmlnaHQgIT09IG51bGwgJiYgbm9kZS5sZWZ0LnJpZ2h0LmxlZnQgPT09IG51bGwgXG4gICAgICAgICAgICAgICAgJiYgbm9kZS5sZWZ0LnJpZ2h0LnJpZ2h0ID09PSBudWxsICYmIG5vZGUubGVmdC5sZWZ0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUubGVmdCA9IG5vZGUubGVmdC5yaWdodFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobm9kZS5yaWdodCAmJiBub2RlLnJpZ2h0LmRhdGEgPT09IHZhbHVlICYmIG5vZGUucmlnaHQubGVmdCAhPT0gbnVsbCAmJiBub2RlLnJpZ2h0LmxlZnQubGVmdCA9PT0gbnVsbCBcbiAgICAgICAgICAgICAgICAmJiBub2RlLnJpZ2h0LmxlZnQucmlnaHQgPT09IG51bGwgJiYgbm9kZS5yaWdodC5yaWdodCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBub2RlLnJpZ2h0ID0gbm9kZS5yaWdodC5sZWZ0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChub2RlLnJpZ2h0ICYmIG5vZGUucmlnaHQuZGF0YSA9PT0gdmFsdWUgJiYgbm9kZS5yaWdodC5yaWdodCAhPT0gbnVsbCAmJiBub2RlLnJpZ2h0LnJpZ2h0LmxlZnQgPT09IG51bGwgXG4gICAgICAgICAgICAgICAgJiYgbm9kZS5yaWdodC5yaWdodC5yaWdodCA9PT0gbnVsbCAmJiBub2RlLnJpZ2h0LmxlZnQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5yaWdodCA9IG5vZGUucmlnaHQucmlnaHRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFRPRE86IGVkZ2UgY2FzZSB3aGVyZSByb290IGlzIGhhcyBvbmUgbGVhZiAodHdvIG5vZGVzIG9ubHkgaW4gdGhlIHRyZWUpXG4gICAgICAgICAgICAvLyByZXF1aXJlcyBjaGVja2luZyBpZiBub2RlIGlzIHJvb3QsIGFuZCBjaGVja2luZyBpZiBpdCBvbmx5IGhhcyBvbmUgbGVhZlxuXG4gICAgICAgICAgICAvLyBDYXNlIDM6IGRlbGV0aW5nIGEgYnJhbmNoIHdpdGggYm90aCBsZWF2ZXM7IGdldCB0aGUgbmV4dCByaWdodCwgdGhlbiBsZWZ0bW9zdCBpIHRoaW5rXG4gICAgICAgICAgICBlbHNlIGlmIChub2RlLmRhdGEgPT09IHZhbHVlICYmIG5vZGUubGVmdCAhPT0gbnVsbCAmJiBub2RlLnJpZ2h0ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgbGV0IHRlbXAgPSBub2RlLnJpZ2h0O1xuICAgICAgICAgICAgICAgIGxldCB0ZW1wUGFyZW50ID0gdGVtcDtcbiAgICAgICAgICAgICAgICB3aGlsZSAodGVtcC5sZWZ0ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBQYXJlbnQgPSB0ZW1wO1xuICAgICAgICAgICAgICAgICAgICB0ZW1wID0gdGVtcC5sZWZ0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBub2RlLmRhdGEgPSB0ZW1wLmRhdGE7XG4gICAgICAgICAgICAgICAgdGVtcFBhcmVudC5sZWZ0ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIENhc2UgNDogY29uc29sZSBsb2cgaWYgdGhlIHZhbHVlIGlzbid0IGZvdW5kXG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IG5vZGUuZGF0YSAmJiBub2RlLnJpZ2h0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYCR7dmFsdWV9IG5vdCBmb3VuZCwgcGxlYXNlIHRyeSBhZ2FpbmApO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlIDwgbm9kZS5kYXRhICYmIG5vZGUubGVmdCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAke3ZhbHVlfSBub3QgZm91bmQsIHBsZWFzZSB0cnkgYWdhaW5gKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA8IG5vZGUuZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWN1cnNpdmVGdW5jdGlvbihub2RlLmxlZnQsIHZhbHVlKVxuICAgICAgICAgICAgfSBlbHNlIGlmICggdmFsdWUgPiBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5yaWdodCwgdmFsdWUpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVjdXJzaXZlRnVuY3Rpb24odGhpcy5yb290LCB2YWx1ZSlcbiAgICB9XG5cbiAgICBmaW5kKHZhbHVlKSB7XG4gICAgICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUsIHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAobm9kZS5kYXRhID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG5vZGUpXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgdmFsdWUgZXhpc3RzIGF0IGxlYWYgb3IgdGhlIGxlYWYgcGFyZW50c1xuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiBub2RlLmRhdGEgJiYgbm9kZS5yaWdodCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAke3ZhbHVlfSBub3QgZm91bmRgKVxuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPCBub2RlLmRhdGEgJiYgbm9kZS5sZWZ0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYCR7dmFsdWV9IG5vdCBmb3VuZGApXG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IG5vZGUuZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWN1cnNpdmVGdW5jdGlvbihub2RlLnJpZ2h0LCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA8IG5vZGUuZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWN1cnNpdmVGdW5jdGlvbihub2RlLmxlZnQsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZWN1cnNpdmVGdW5jdGlvbih0aGlzLnJvb3QsIHZhbHVlKVxuICAgIH1cblxuICAgIGxldmVsT3JkZXJSZWN1cnNpdmUoaGVscGVyRnVuY3Rpb24pIHtcbiAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlRnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgbGV0IHF1ZXVlID0gW107XG4gICAgICAgICAgICAvLyBUaGVyZSBuZWVkcyB0byBiZSBzb21lIHNvcnQgb2YgcXVldWUsIEkgdGhpbmsgaXQgbmVlZHMgdG8gYmUgaW5zaWRlIHRoZSBmdW5jdGlvblxuICAgICAgICAgICAgLy8gYmFzZSBjYXNlOiBpZiB0aGUgbGVhZiBicmFuY2hlcyBhcmUgcmVhY2hlZD9cbiAgICAgICAgICAgIGlmIChub2RlLmxlZnQgPT09IG51bGwgfHwgbm9kZS5yaWdodCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBhIGNoYWluLCBvbmUgdGhhdCBjb250aW51b3VzbHkgYWRkcyBhbmQgZGVsZXRlcyBub2Rlc1xuICAgICAgICAgICAgICAgIHF1ZXVlLnB1c2gobm9kZSlcbiAgICAgICAgICAgICAgICBoZWxwZXJGdW5jdGlvbihub2RlKVxuICAgICAgICAgICAgICAgIHF1ZXVlLnNoaWZ0KClcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5sZWZ0KSBxdWV1ZS5wdXNoKG5vZGUubGVmdClcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5yaWdodCkgcXVldWUucHVzaChub2RlLnJpZ2h0KVxuXG4gICAgICAgICAgICAgICAgLy8gYWxzbyB0cmF2ZXJzZSBkb3duIHRoZSBjaGFpblxuICAgICAgICAgICAgICAgIC8vIGdvIGxlZnQ/IGdvIHJpZ2h0P1xuICAgICAgICAgICAgICAgIHJldHVybiByZWN1cnNpdmVGdW5jdGlvbigpXG4gICAgICAgICAgICAgICAgLy8gZG8gaSBuZWVkIHRvIGhhdmUgcmVjdXJpc3ZlRnVuY3Rpb24gcmV0dXJuIHRvIHRoZSBxdWV1ZT9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vcmVjdXJzaXZlXG4gICAgICAgICAgICAvLyBtYXkgaGF2ZSB0byBzZXQgcm9vdCwgYW5kIGdldCB0aGUgY2hpbGRyZW5cbiAgICAgICAgICAgIC8vIGFkZCB0aGUgdmFsdWUgdG8gYSBxdWV1ZSwgdGFrZSBpdCBvdXQsIGFuZCB0aGVuIGFkZCB0aGUgY2hpbGRyZW4gdG8gYSBxdWV1ZT9cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGxldmVsT3JkZXJJdGVyYXRpdmUoaGVscGVyRnVuY3Rpb24pIHtcbiAgICAgICAgbGV0IHF1ZXVlID0gW11cbiAgICAgICAgcXVldWUucHVzaCh0aGlzLnJvb3QpXG4gICAgICAgIHdoaWxlIChxdWV1ZS5sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgIGhlbHBlckZ1bmN0aW9uKHF1ZXVlWzBdKVxuICAgICAgICAgICAgaWYgKHF1ZXVlWzBdLmxlZnQpIHF1ZXVlLnB1c2gocXVldWVbMF0ubGVmdClcbiAgICAgICAgICAgIGlmIChxdWV1ZVswXS5yaWdodCkgcXVldWUucHVzaChxdWV1ZVswXS5yaWdodClcbiAgICAgICAgICAgIHF1ZXVlLnNoaWZ0KClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByZU9yZGVyKGhlbHBlckZ1bmN0aW9uKSB7XG4gICAgICAgIGlmIChoZWxwZXJGdW5jdGlvbikge1xuICAgICAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlRnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgIGhlbHBlckZ1bmN0aW9uKG5vZGUpXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUubGVmdCA9PT0gbnVsbCAmJiBub2RlLnJpZ2h0ID09PSBudWxsKSByZXR1cm5cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubGVmdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnJpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWN1cnNpdmVGdW5jdGlvbihub2RlLnJpZ2h0KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVjdXJzaXZlRnVuY3Rpb24odGhpcy5yb290KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlRnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgIGxldCByZWN1cnNpdmVWYWx1ZSA9IFtub2RlLmRhdGFdO1xuICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQgPT09IG51bGwgJiYgbm9kZS5yaWdodCA9PT0gbnVsbCkgcmV0dXJuIFtub2RlLmRhdGFdXG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQpIHJlY3Vyc2l2ZVZhbHVlID0gcmVjdXJzaXZlVmFsdWUuY29uY2F0KHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUubGVmdCkpXG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnJpZ2h0KSByZWN1cnNpdmVWYWx1ZSA9IHJlY3Vyc2l2ZVZhbHVlLmNvbmNhdChyZWN1cnNpdmVGdW5jdGlvbihub2RlLnJpZ2h0KSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZVZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlY3Vyc2l2ZUZ1bmN0aW9uKHRoaXMucm9vdCkpXG5cbiAgICAgICAgICAgIC8vIGNsZWFuZXIgdmVyc2lvbjsgYmFzZSBjYXNlIGlzIG5vdCBzdGF0ZWQsIGFzIGRvIG5vdCBuZWVkIHRvIHN0YXRlIGlmIG51bGxcbiAgICAgICAgICAgIC8vIGZ1bmN0aW9uIHJlY3Vyc2l2ZVRyYXZlcnNhbChub2RlKSB7XG4gICAgICAgICAgICAvLyBsZXQgYXJyYXkgPSBbbm9kZS5kYXRhXSAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gaWYgKG5vZGUubGVmdCkgYXJyYXkgPSBhcnJheS5jb25jYXQocmVjdXJzaXZlVHJhdmVyc2FsKG5vZGUubGVmdCkpIC8vIFwiY29ubmVjdGluZ1wiIGFycmF5c1xuICAgICAgICAgICAgLy8gaWYgKG5vZGUucmlnaHQpIGFycmF5ID0gYXJyYXkuY29uY2F0KHJlY3Vyc2l2ZVRyYXZlcnNhbChub2RlLnJpZ2h0KSkgLy8gXCJjb25uZWN0aW5nXCIgYXJyYXlzXG4gICAgICAgICAgICAvLyByZXR1cm4gYXJyYXlcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlY3Vyc2l2ZVRyYXZlcnNhbCh0aGlzLnJvb3QpKVxuICAgICAgICAgICAgLy8gfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gZG8gdGhlIHNhbWUgZm9yIHByZU9yZGVyIGFuZCBwb3N0T3JkZXJcbiAgICBpbk9yZGVyKGhlbHBlckZ1bmN0aW9uKSB7XG4gICAgICAgIGlmIChoZWxwZXJGdW5jdGlvbikge1xuICAgICAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlRnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQgPT09IG51bGwgJiYgbm9kZS5yaWdodCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBoZWxwZXJGdW5jdGlvbihub2RlKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5sZWZ0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWN1cnNpdmVGdW5jdGlvbihub2RlLmxlZnQpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaGVscGVyRnVuY3Rpb24obm9kZSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUucmlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUucmlnaHQpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWN1cnNpdmVGdW5jdGlvbih0aGlzLnJvb3QpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVGdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgbGV0IHJlY3Vyc2l2ZVZhbHVlID0gW107XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQpIHJlY3Vyc2l2ZVZhbHVlID0gcmVjdXJzaXZlVmFsdWUuY29uY2F0KHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUubGVmdCkpXG4gICAgICAgICAgICAgICAgICAgIHJlY3Vyc2l2ZVZhbHVlID0gcmVjdXJzaXZlVmFsdWUuY29uY2F0KFtub2RlLmRhdGFdKVxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5yaWdodCkgcmVjdXJzaXZlVmFsdWUgPSByZWN1cnNpdmVWYWx1ZS5jb25jYXQocmVjdXJzaXZlRnVuY3Rpb24obm9kZS5yaWdodCkpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWN1cnNpdmVWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlY3Vyc2l2ZUZ1bmN0aW9uKHRoaXMucm9vdCkpXG4gICAgICAgIH1cblxuICAgIH1cblxuXG4gICAgLy8gaGVpZ2h0OyBmaW5kIGxvbmdlc3QgbGVuZ3RoIGJldHdlZW4gdGhpcyBub2RlLCBhbmQgbGVhZiBub2RlLiBob3c/IGRvIGkgbmVlZCB0byB1c2UgZmluZD9cbiAgICAvLyBoZWlnaHQodmFsdWUpIHtcbiAgICAvLyAgICAgLy9maXJzdCwgbmVlZCB0byBmaW5kIHRoZSBub2RlXG4gICAgLy8gICAgIC8vIHRoZW4sIG5lZWQgdG8gXG4gICAgLy8gICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZVRyYXZlcnNhbChjdXJyZW50Tm9kZSwgdmFsdWUpIHtcbiAgICAvLyAgICAgICAgIGlmIChjdXJyZW50Tm9kZSA9IClcblxuICAgIC8vICAgICB9XG4gICAgLy8gfVxufVxuXG5cbmZ1bmN0aW9uIGJ1aWxkVHJlZShhcnJheSkge1xuICAgICAgICBsZXQgc29ydGVkQXJyYXkgPSBtZXJnZVNvcnQoYXJyYXkpXG4gICAgICAgIGxldCByZW1vdmVkRHVwbGljYXRlcyA9IFsuLi4gbmV3IFNldChzb3J0ZWRBcnJheSldXG4gICAgICAgIHJldHVybiByZWN1cnNpdmVCdWlsZFRyZWUocmVtb3ZlZER1cGxpY2F0ZXMpXG59XG5cbmZ1bmN0aW9uIHJlY3Vyc2l2ZUJ1aWxkVHJlZShhcnJheSkge1xuICAgIGlmIChhcnJheS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIG51bGw7IC8vIHdoYXQgZG8gaSBuZWVkIHRvIHJldHVybj8gYXJyYXk/IG5vZGU/XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgbWlkZGxlSW5kZXggPSBNYXRoLmZsb29yKGFycmF5Lmxlbmd0aC8yKVxuICAgICAgICBjb25zdCByb290ID0gbmV3IE5vZGUoYXJyYXlbbWlkZGxlSW5kZXhdKVxuXG4gICAgICAgIHJvb3QubGVmdCA9IHJlY3Vyc2l2ZUJ1aWxkVHJlZShhcnJheS5zbGljZSgwLCBtaWRkbGVJbmRleCkpXG4gICAgICAgIHJvb3QucmlnaHQgPSByZWN1cnNpdmVCdWlsZFRyZWUoYXJyYXkuc2xpY2UobWlkZGxlSW5kZXggKyAxKSlcbiAgICAgICAgcmV0dXJuIHJvb3Q7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBpbnNlcnQodmFsdWUpIHtcbiAgICBmdW5jdGlvbiByZWN1cnNpdmVGdW5jdGlvbihub2RlLCB2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgPCBub2RlLmRhdGEgJiYgbm9kZS5sZWZ0ID09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnN0IG5ld05vZGUgPSBuZXcgTm9kZSh2YWx1ZSk7XG4gICAgICAgICAgICBub2RlLmxlZnQgPSBuZXdOb2RlO1xuICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID4gbm9kZS5kYXRhICYmIG5vZGUucmlnaHQgPT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3QgbmV3Tm9kZSA9IG5ldyBOb2RlKHZhbHVlKTtcbiAgICAgICAgICAgIG5vZGUucmlnaHQgPSBuZXdOb2RlO1xuICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIDwgbm9kZS5kYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0KVxuICAgICAgICAgICAgLy8gY3JlYXRlIG5ldyBub2RlLCBtYWtlIGl0IHRoZSBjaGlsZCBvZiB0aGUgcHJldmlvdXMgbm9kZSwgYW5kIHRoZSBuZXcgcm9vdCBvZiB0aGUgbmV4dCBub2Rlc1xuICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID4gbm9kZS5kYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5yaWdodClcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PSBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidmFsdWUgYWxyZWFkeSBpbiB0cmVlLCB0cnkgYW5vdGhlciB2YWx1ZVwiKVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVjdXJzaXZlRnVuY3Rpb24oKVxufSIsImV4cG9ydCBjb25zdCBwcmV0dHlQcmludCA9IChub2RlLCBwcmVmaXggPSBcIlwiLCBpc0xlZnQgPSB0cnVlKSA9PiB7XG4gIGlmIChub2RlID09PSBudWxsKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChub2RlLnJpZ2h0ICE9PSBudWxsKSB7XG4gICAgcHJldHR5UHJpbnQobm9kZS5yaWdodCwgYCR7cHJlZml4fSR7aXNMZWZ0ID8gXCLilIIgICBcIiA6IFwiICAgIFwifWAsIGZhbHNlKTtcbiAgfVxuICBjb25zb2xlLmxvZyhgJHtwcmVmaXh9JHtpc0xlZnQgPyBcIuKUlOKUgOKUgCBcIiA6IFwi4pSM4pSA4pSAIFwifSR7bm9kZS5kYXRhfWApO1xuICBpZiAobm9kZS5sZWZ0ICE9PSBudWxsKSB7XG4gICAgcHJldHR5UHJpbnQobm9kZS5sZWZ0LCBgJHtwcmVmaXh9JHtpc0xlZnQgPyBcIiAgICBcIiA6IFwi4pSCICAgXCJ9YCwgdHJ1ZSk7XG4gIH1cbn07IiwiLy8gaW1wb3J0IHsgTm9kZSwgVHJlZSwgYnVpbGRUcmVlIH0gZnJvbSBcIi4vYmluYXJ5U2VhcmNoVHJlZVwiO1xuaW1wb3J0IHsgVHJlZSB9IGZyb20gXCIuL2JpbmFyeVNlYXJjaFRyZWVcIjtcbmltcG9ydCB7IHByZXR0eVByaW50IH0gZnJvbSBcIi4vcHJldHR5UHJpbnRcIjtcblxuY29uc3QgdGVzdEFycmF5ID0gWzEsIDcsIDQsIDIzLCA4LCA5LCA0LCAzLCA1LCA3LCA5LCA2NywgNjM0NSwgMzI0XVxuXG5cbi8vIGJ1aWxkVHJlZSh0ZXN0QXJyYXkpXG5sZXQgbmV3VHJlZSA9IG5ldyBUcmVlKHRlc3RBcnJheSlcbi8vIHByZXR0eVByaW50KG5ld1RyZWUucm9vdClcblxubmV3VHJlZS5pbnNlcnQoOSlcbi8vIHByZXR0eVByaW50KG5ld1RyZWUucm9vdClcblxubmV3VHJlZS5kZWxldGUoMzIzKVxucHJldHR5UHJpbnQobmV3VHJlZS5yb290KVxuXG5uZXdUcmVlLmZpbmQoNilcbm5ld1RyZWUuZmluZCgxKVxuXG4vLyBuZXdUcmVlLmxldmVsT3JkZXJJdGVyYXRpdmUoKG5vZGUpID0+IGNvbnNvbGUubG9nKG5vZGUpKVxuXG5uZXdUcmVlLnByZU9yZGVyKClcblxubmV3VHJlZS5wcmVPcmRlcigobm9kZSk9PiBjb25zb2xlLmxvZyhub2RlLmRhdGEpKVxuXG5uZXdUcmVlLmluT3JkZXIoKSJdLCJuYW1lcyI6WyJtZXJnZVNvcnQiLCJhcnJheSIsImxlbmd0aCIsImhhbGYiLCJNYXRoIiwiY2VpbCIsInNvcnRlZExlZnRIYWxmIiwic2xpY2UiLCJzb3J0ZWRSaWdodEhhbGYiLCJtZXJnZWRBcnJheSIsInB1c2giLCJzaGlmdCIsIk5vZGUiLCJjb25zdHJ1Y3RvciIsInZhbHVlIiwidGhpcyIsImRhdGEiLCJsZWZ0IiwicmlnaHQiLCJyZWN1cnNpdmVCdWlsZFRyZWUiLCJtaWRkbGVJbmRleCIsImZsb29yIiwicm9vdCIsInByZXR0eVByaW50Iiwibm9kZSIsInByZWZpeCIsImlzTGVmdCIsImNvbnNvbGUiLCJsb2ciLCJuZXdUcmVlIiwic29ydGVkQXJyYXkiLCJTZXQiLCJidWlsZFRyZWUiLCJpbnNlcnQiLCJyZWN1cnNpdmVGdW5jdGlvbiIsIm5ld05vZGUiLCJ0ZW1wIiwidGVtcFBhcmVudCIsImZpbmQiLCJsZXZlbE9yZGVyUmVjdXJzaXZlIiwiaGVscGVyRnVuY3Rpb24iLCJsZXZlbE9yZGVySXRlcmF0aXZlIiwicXVldWUiLCJwcmVPcmRlciIsInJlY3Vyc2l2ZVZhbHVlIiwiY29uY2F0IiwiaW5PcmRlciIsImRlbGV0ZSJdLCJzb3VyY2VSb290IjoiIn0=