(()=>{"use strict";function t(l){if(1===l.length)return l;{const e=Math.ceil(l.length/2);let r=t(l.slice(0,e)),i=t(l.slice(e)),n=[];for(;r[0]||i[0];)r[0]<i[0]?(n.push(r[0]),r.shift()):i[0]<r[0]?(n.push(i[0]),i.shift()):r[0]==i[0]?(n.push(r[0]),n.push(i[0]),r.shift(),i.shift()):r[0]?i[0]||(n.push(r[0]),r.shift()):(n.push(i[0]),i.shift());return n}}class l{constructor(t){this.data=t,this.left=null,this.right=null}}function e(t){if(0===t.length)return null;{const r=Math.floor(t.length/2),i=new l(t[r]);return i.left=e(t.slice(0,r)),i.right=e(t.slice(r+1)),i}}const r=(t,l="",e=!0)=>{null!==t&&(null!==t.right&&r(t.right,`${l}${e?"│   ":"    "}`,!1),console.log(`${l}${e?"└── ":"┌── "}${t.data}`),null!==t.left&&r(t.left,`${l}${e?"    ":"│   "}`,!0))};let i=new class{constructor(l){this.root=function(l){let r=t(l);return e([...new Set(r)])}(l)}insert(t){!function t(e,r){if(r<e.data&&null==e.left){const t=new l(r);e.left=t}else if(r>e.data&&null==e.right){const t=new l(r);e.right=t}else{if(r<e.data)return t(e.left,r);if(r>e.data)return t(e.right,r);if(r==e.data)return void console.log("value already in tree, try another value")}}(this.root,t)}delete(t){!function t(l,e){if(l.left&&l.left.data===e&&null===l.left.left&&null===l.left.right)l.left=null;else if(l.right&&l.right.data===e&&null===l.right.left&&null===l.right.right)l.right=null;else if(l.left&&l.left.data===e&&null!==l.left.left&&null===l.left.left.left&&null===l.left.left.right&&null===l.left.right)l.left=l.left.left;else if(l.left&&l.left.data===e&&null!==l.left.right&&null===l.left.right.left&&null===l.left.right.right&&null===l.left.left)l.left=l.left.right;else if(l.right&&l.right.data===e&&null!==l.right.left&&null===l.right.left.left&&null===l.right.left.right&&null===l.right.right)l.right=l.right.left;else if(l.right&&l.right.data===e&&null!==l.right.right&&null===l.right.right.left&&null===l.right.right.right&&null===l.right.left)l.right=l.right.right;else if(l.data===e&&null!==l.left&&null!==l.right){let t=l.right,e=t;for(;null!==t.left;)e=t,t=t.left;l.data=t.data,e.left=null}else{if(e>l.data&&null===l.right)return void console.log(`${e} not found, please try again`);if(e<l.data&&null===l.left)return void console.log(`${e} not found, please try again`);if(e<l.data)return t(l.left,e);if(e>l.data)return t(l.right,e)}}(this.root,t)}find(t){!function t(l,e){if(l.data===e)return console.log(l),l;if(e>l.data&&null===l.right)console.log(`${e} not found`);else{if(!(e<l.data&&null===l.left))return e>l.data?t(l.right,e):e<l.data?t(l.left,e):void 0;console.log(`${e} not found`)}}(this.root,t)}levelOrderRecursive(t){}levelOrderIterative(t){let l=[];for(l.push(this.root);0!==l.length;)t(l[0]),l[0].left&&l.push(l[0].left),l[0].right&&l.push(l[0].right),l.shift()}preOrder(t){if(t){function l(e){t(e),null===e.left&&null===e.right||(e.left&&l(e.left),e.right&&l(e.right))}l(this.root)}else{function e(t){let l=[t.data];return null===t.left&&null===t.right?[t.data]:(t.left&&(l=l.concat(e(t.left))),t.right&&(l=l.concat(e(t.right))),l)}console.log(e(this.root))}}inOrder(t){if(t){function l(e){null!==e.left||null!==e.right?(e.left&&l(e.left),t(e),e.right&&l(e.right)):t(e)}l(this.root)}else{function e(t){let l=[t.data];return null===t.left&&null===t.right?[t.data]:(t.left&&(l=l.concat(e(t.left))),t.right&&(l=l.concat(e(t.right))),l)}console.log(e(this.root))}}}([1,7,4,23,8,9,4,3,5,7,9,67,6345,324]);i.insert(9),i.delete(323),r(i.root),i.find(6),i.find(1),i.inOrder(),i.preOrder((t=>console.log(t.data)))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TSxFQUFLUCxNQUNMaUIsRUFBa0JWLEVBQUtQLE1BRTNCdUIsRUFBZWhCLEdBQ1hBLEVBQUtOLE9BQ0xnQixFQUFrQlYsRUFBS04sUUFUM0JzQixFQUFlaEIsRUFZdkIsQ0FDQVUsRUFBa0JuQixLQUFLTyxLQUMzQixLQUFPLENBQ0gsU0FBU1ksRUFBa0JWLEdBQ3ZCLElBQUlvQixFQUFpQixDQUFDcEIsRUFBS1IsTUFDM0IsT0FBa0IsT0FBZFEsRUFBS1AsTUFBZ0MsT0FBZk8sRUFBS04sTUFBdUIsQ0FBQ00sRUFBS1IsT0FFcERRLEVBQUtQLE9BQU0yQixFQUFpQkEsRUFBZUMsT0FBT1gsRUFBa0JWLEVBQUtQLFFBQ3pFTyxFQUFLTixRQUFPMEIsRUFBaUJBLEVBQWVDLE9BQU9YLEVBQWtCVixFQUFLTixTQUN2RTBCLEVBRWYsQ0FDQWpCLFFBQVFDLElBQUlNLEVBQWtCbkIsS0FBS08sTUFDdkMsQ0FFSixHRXZPYyxDQUFDLEVBQUcsRUFBRyxFQUFHLEdBQUksRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxHQUFJLEtBQU0sTUFPL0RPLEVBQVFJLE9BQU8sR0FHZkosRUFBUWtCLE9BQU8sS0FDZnhCLEVBQVlNLEVBQVFQLE1BRXBCTyxFQUFRUyxLQUFLLEdBQ2JULEVBQVFTLEtBQUssR0FJYlQsRUFBUWlCLFVBRVJqQixFQUFRYyxVQUFVbkIsR0FBUUcsUUFBUUMsSUFBSUosRUFBS1IsTyIsInNvdXJjZXMiOlsid2VicGFjazovL3RvcC1iYWxhbmNlZC1iaW5hcnktc2VhcmNoLXRyZWUvLi9zcmMvbWVyZ2VTb3J0LmpzIiwid2VicGFjazovL3RvcC1iYWxhbmNlZC1iaW5hcnktc2VhcmNoLXRyZWUvLi9zcmMvYmluYXJ5U2VhcmNoVHJlZS5qcyIsIndlYnBhY2s6Ly90b3AtYmFsYW5jZWQtYmluYXJ5LXNlYXJjaC10cmVlLy4vc3JjL3ByZXR0eVByaW50LmpzIiwid2VicGFjazovL3RvcC1iYWxhbmNlZC1iaW5hcnktc2VhcmNoLXRyZWUvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIG1lcmdlU29ydChhcnJheSkge1xuICAgIGlmIChhcnJheS5sZW5ndGggPT09IDEpIHJldHVybiBhcnJheTtcbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3QgaGFsZiA9IE1hdGguY2VpbChhcnJheS5sZW5ndGgvMilcbiAgICAgICAgLy8gc3BsaXQgYXJyYXkgaW4gaGFsZlxuICAgICAgICBjb25zdCBsZWZ0SGFsZiA9IGFycmF5LnNsaWNlKDAsIGhhbGYpXG4gICAgICAgIC8vIGNhbGwgbWVyZ2VTb3J0IG9uIHRoZSBsZWZ0IGhhbGZcbiAgICAgICAgbGV0IHNvcnRlZExlZnRIYWxmID0gbWVyZ2VTb3J0KGxlZnRIYWxmKVxuXG4gICAgICAgIGNvbnN0IHJpZ2h0SGFsZiA9IGFycmF5LnNsaWNlKGhhbGYpXG4gICAgICAgIC8vIGNhbGwgbWVyZ2VTb3J0IG9uIHRoZSByaWdodCBoYWxmXG4gICAgICAgIGxldCBzb3J0ZWRSaWdodEhhbGYgPSBtZXJnZVNvcnQocmlnaHRIYWxmKTtcblxuICAgICAgICAvL2ZvciBlYWNoIGVsZW1lbnQgaW4gbGVmdCBoYWxmIGFuZCByaWdodCBoYWxmLCBzZWUgd2hpY2ggaXMgc21hbGxlclxuICAgICAgICBsZXQgbWVyZ2VkQXJyYXkgPSBbXTtcbiAgICAgICAgd2hpbGUgKHNvcnRlZExlZnRIYWxmWzBdIHx8IHNvcnRlZFJpZ2h0SGFsZlswXSkge1xuICAgICAgICAgICAgaWYgKHNvcnRlZExlZnRIYWxmWzBdIDwgc29ydGVkUmlnaHRIYWxmWzBdKSB7XG4gICAgICAgICAgICAgICAgbWVyZ2VkQXJyYXkucHVzaChzb3J0ZWRMZWZ0SGFsZlswXSlcbiAgICAgICAgICAgICAgICBzb3J0ZWRMZWZ0SGFsZi5zaGlmdCgpXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNvcnRlZFJpZ2h0SGFsZlswXSA8IHNvcnRlZExlZnRIYWxmWzBdKSB7XG4gICAgICAgICAgICAgICAgbWVyZ2VkQXJyYXkucHVzaChzb3J0ZWRSaWdodEhhbGZbMF0pXG4gICAgICAgICAgICAgICAgc29ydGVkUmlnaHRIYWxmLnNoaWZ0KClcblxuICAgICAgICAgICAgICAgIC8vIGVkZ2UgY2FzZSB3aGVyZSB0aGUgc2FtZSBudW1iZXIgaXMgYmVpbmcgY29tcGFyZWRcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc29ydGVkTGVmdEhhbGZbMF0gPT0gc29ydGVkUmlnaHRIYWxmWzBdKSB7XG4gICAgICAgICAgICAgICAgbWVyZ2VkQXJyYXkucHVzaChzb3J0ZWRMZWZ0SGFsZlswXSlcbiAgICAgICAgICAgICAgICBtZXJnZWRBcnJheS5wdXNoKHNvcnRlZFJpZ2h0SGFsZlswXSlcbiAgICAgICAgICAgICAgICBzb3J0ZWRMZWZ0SGFsZi5zaGlmdCgpXG4gICAgICAgICAgICAgICAgc29ydGVkUmlnaHRIYWxmLnNoaWZ0KClcbiAgICAgICAgICAgICAgICAvLyBlZGdlIGNhc2Ugd2hlcmUgb25lIGFycmF5IGlzIGVtcHR5XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzb3J0ZWRMZWZ0SGFsZlswXSkge1xuICAgICAgICAgICAgICAgIG1lcmdlZEFycmF5LnB1c2goc29ydGVkUmlnaHRIYWxmWzBdKVxuICAgICAgICAgICAgICAgIHNvcnRlZFJpZ2h0SGFsZi5zaGlmdCgpXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzb3J0ZWRSaWdodEhhbGZbMF0pIHtcbiAgICAgICAgICAgICAgICBtZXJnZWRBcnJheS5wdXNoKHNvcnRlZExlZnRIYWxmWzBdKVxuICAgICAgICAgICAgICAgIHNvcnRlZExlZnRIYWxmLnNoaWZ0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1lcmdlZEFycmF5O1xuICAgIH1cbn0iLCJpbXBvcnQgeyBtZXJnZVNvcnQgfSBmcm9tIFwiLi9tZXJnZVNvcnRcIjtcblxuaW1wb3J0IHsgcHJldHR5UHJpbnQgfSBmcm9tIFwiLi9wcmV0dHlQcmludFwiO1xuXG5jbGFzcyBOb2RlIHtcbiAgICBjb25zdHJ1Y3Rvcih2YWx1ZSkge1xuICAgICAgICB0aGlzLmRhdGE9IHZhbHVlO1xuICAgICAgICB0aGlzLmxlZnQgPSBudWxsO1xuICAgICAgICB0aGlzLnJpZ2h0ID0gbnVsbDtcbiAgICB9XG59XG5leHBvcnQgY2xhc3MgVHJlZSB7XG4gICAgY29uc3RydWN0b3IoYXJyYXkpIHtcbiAgICAgICAgdGhpcy5yb290ID0gYnVpbGRUcmVlKGFycmF5KTtcbiAgICB9XG5cblxuICAgIGluc2VydCh2YWx1ZSkge1xuICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVGdW5jdGlvbihub2RlLCB2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlIDwgbm9kZS5kYXRhICYmIG5vZGUubGVmdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3Tm9kZSA9IG5ldyBOb2RlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBub2RlLmxlZnQgPSBuZXdOb2RlO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID4gbm9kZS5kYXRhICYmIG5vZGUucmlnaHQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld05vZGUgPSBuZXcgTm9kZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgbm9kZS5yaWdodCA9IG5ld05vZGU7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPCBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0LCB2YWx1ZSlcblxuICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+IG5vZGUuZGF0YSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZWN1cnNpdmVGdW5jdGlvbihub2RlLnJpZ2h0LCB2YWx1ZSlcblxuICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PSBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInZhbHVlIGFscmVhZHkgaW4gdHJlZSwgdHJ5IGFub3RoZXIgdmFsdWVcIilcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZWN1cnNpdmVGdW5jdGlvbih0aGlzLnJvb3QsIHZhbHVlKVxuICAgIH1cblxuICAgIGRlbGV0ZSh2YWx1ZSkge1xuICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVGdW5jdGlvbihub2RlLCB2YWx1ZSkge1xuICAgICAgICAgICAgLy8gdGhpcyBjb2RlIHJlcXVpcmVzIGd1YXJkIGNsYXVzZTogaWYobm9kZS5sZWZ0KSwgb3IgaWYobm9kZS5yaWdodClcbiAgICAgICAgICAgIC8vIGNvbnNpZGVyIGF0IGxlYXN0IDQgY2FzZXNcbiAgICAgICAgICAgIC8vIENhc2UgMTogZGVsZXRpbmcgdGhlIGxlYWYgbm9kZVxuICAgICAgICAgICAgaWYgKG5vZGUubGVmdCAmJiBub2RlLmxlZnQuZGF0YSA9PT0gdmFsdWUgJiYgbm9kZS5sZWZ0LmxlZnQgPT09IG51bGwgJiYgbm9kZS5sZWZ0LnJpZ2h0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgbm9kZS5sZWZ0ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUucmlnaHQgJiYgbm9kZS5yaWdodC5kYXRhID09PSB2YWx1ZSAmJiBub2RlLnJpZ2h0LmxlZnQgPT09IG51bGwgJiYgbm9kZS5yaWdodC5yaWdodCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG5vZGUucmlnaHQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQ2FzZSAyOiBkZWxldGluZyBhIGJyYW5jaCBub2RlIHdpdGggb25lIGxlYWY7IHBvaW50IHRoZSBwcmVjZWRpbmcgY2hpbGQgdG8gdGhlIDJuZCBmb2xsb3dpbmcgY2hpbGRcbiAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUubGVmdCAmJiBub2RlLmxlZnQuZGF0YSA9PT0gdmFsdWUgJiYgbm9kZS5sZWZ0LmxlZnQgIT09IG51bGwgJiYgbm9kZS5sZWZ0LmxlZnQubGVmdCA9PT0gbnVsbCBcbiAgICAgICAgICAgICAgICAmJiBub2RlLmxlZnQubGVmdC5yaWdodCA9PT0gbnVsbCAmJiBub2RlLmxlZnQucmlnaHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5sZWZ0ID0gbm9kZS5sZWZ0LmxlZnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUubGVmdCAmJiBub2RlLmxlZnQuZGF0YSA9PT0gdmFsdWUgJiYgbm9kZS5sZWZ0LnJpZ2h0ICE9PSBudWxsICYmIG5vZGUubGVmdC5yaWdodC5sZWZ0ID09PSBudWxsIFxuICAgICAgICAgICAgICAgICYmIG5vZGUubGVmdC5yaWdodC5yaWdodCA9PT0gbnVsbCAmJiBub2RlLmxlZnQubGVmdCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBub2RlLmxlZnQgPSBub2RlLmxlZnQucmlnaHRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUucmlnaHQgJiYgbm9kZS5yaWdodC5kYXRhID09PSB2YWx1ZSAmJiBub2RlLnJpZ2h0LmxlZnQgIT09IG51bGwgJiYgbm9kZS5yaWdodC5sZWZ0LmxlZnQgPT09IG51bGwgXG4gICAgICAgICAgICAgICAgJiYgbm9kZS5yaWdodC5sZWZ0LnJpZ2h0ID09PSBudWxsICYmIG5vZGUucmlnaHQucmlnaHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5yaWdodCA9IG5vZGUucmlnaHQubGVmdFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobm9kZS5yaWdodCAmJiBub2RlLnJpZ2h0LmRhdGEgPT09IHZhbHVlICYmIG5vZGUucmlnaHQucmlnaHQgIT09IG51bGwgJiYgbm9kZS5yaWdodC5yaWdodC5sZWZ0ID09PSBudWxsIFxuICAgICAgICAgICAgICAgICYmIG5vZGUucmlnaHQucmlnaHQucmlnaHQgPT09IG51bGwgJiYgbm9kZS5yaWdodC5sZWZ0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUucmlnaHQgPSBub2RlLnJpZ2h0LnJpZ2h0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBUT0RPOiBlZGdlIGNhc2Ugd2hlcmUgcm9vdCBpcyBoYXMgb25lIGxlYWYgKHR3byBub2RlcyBvbmx5IGluIHRoZSB0cmVlKVxuICAgICAgICAgICAgLy8gcmVxdWlyZXMgY2hlY2tpbmcgaWYgbm9kZSBpcyByb290LCBhbmQgY2hlY2tpbmcgaWYgaXQgb25seSBoYXMgb25lIGxlYWZcblxuICAgICAgICAgICAgLy8gQ2FzZSAzOiBkZWxldGluZyBhIGJyYW5jaCB3aXRoIGJvdGggbGVhdmVzOyBnZXQgdGhlIG5leHQgcmlnaHQsIHRoZW4gbGVmdG1vc3QgaSB0aGlua1xuICAgICAgICAgICAgZWxzZSBpZiAobm9kZS5kYXRhID09PSB2YWx1ZSAmJiBub2RlLmxlZnQgIT09IG51bGwgJiYgbm9kZS5yaWdodCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGxldCB0ZW1wID0gbm9kZS5yaWdodDtcbiAgICAgICAgICAgICAgICBsZXQgdGVtcFBhcmVudCA9IHRlbXA7XG4gICAgICAgICAgICAgICAgd2hpbGUgKHRlbXAubGVmdCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wUGFyZW50ID0gdGVtcDtcbiAgICAgICAgICAgICAgICAgICAgdGVtcCA9IHRlbXAubGVmdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbm9kZS5kYXRhID0gdGVtcC5kYXRhO1xuICAgICAgICAgICAgICAgIHRlbXBQYXJlbnQubGVmdCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBDYXNlIDQ6IGNvbnNvbGUgbG9nIGlmIHRoZSB2YWx1ZSBpc24ndCBmb3VuZFxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiBub2RlLmRhdGEgJiYgbm9kZS5yaWdodCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAke3ZhbHVlfSBub3QgZm91bmQsIHBsZWFzZSB0cnkgYWdhaW5gKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA8IG5vZGUuZGF0YSAmJiBub2RlLmxlZnQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgJHt2YWx1ZX0gbm90IGZvdW5kLCBwbGVhc2UgdHJ5IGFnYWluYCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPCBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0LCB2YWx1ZSlcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIHZhbHVlID4gbm9kZS5kYXRhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUucmlnaHQsIHZhbHVlKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJlY3Vyc2l2ZUZ1bmN0aW9uKHRoaXMucm9vdCwgdmFsdWUpXG4gICAgfVxuXG4gICAgZmluZCh2YWx1ZSkge1xuICAgICAgICBmdW5jdGlvbiByZWN1cnNpdmVGdW5jdGlvbihub2RlLCB2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKG5vZGUuZGF0YSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhub2RlKVxuICAgICAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHZhbHVlIGV4aXN0cyBhdCBsZWFmIG9yIHRoZSBsZWFmIHBhcmVudHNcbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gbm9kZS5kYXRhICYmIG5vZGUucmlnaHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgJHt2YWx1ZX0gbm90IGZvdW5kYClcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlIDwgbm9kZS5kYXRhICYmIG5vZGUubGVmdCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAke3ZhbHVlfSBub3QgZm91bmRgKVxuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5yaWdodCwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPCBub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0LCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVjdXJzaXZlRnVuY3Rpb24odGhpcy5yb290LCB2YWx1ZSlcbiAgICB9XG5cbiAgICBsZXZlbE9yZGVyUmVjdXJzaXZlKGhlbHBlckZ1bmN0aW9uKSB7XG4gICAgICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgIGxldCBxdWV1ZSA9IFtdO1xuICAgICAgICAgICAgLy8gVGhlcmUgbmVlZHMgdG8gYmUgc29tZSBzb3J0IG9mIHF1ZXVlLCBJIHRoaW5rIGl0IG5lZWRzIHRvIGJlIGluc2lkZSB0aGUgZnVuY3Rpb25cbiAgICAgICAgICAgIC8vIGJhc2UgY2FzZTogaWYgdGhlIGxlYWYgYnJhbmNoZXMgYXJlIHJlYWNoZWQ/XG4gICAgICAgICAgICBpZiAobm9kZS5sZWZ0ID09PSBudWxsIHx8IG5vZGUucmlnaHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBjcmVhdGUgYSBjaGFpbiwgb25lIHRoYXQgY29udGludW91c2x5IGFkZHMgYW5kIGRlbGV0ZXMgbm9kZXNcbiAgICAgICAgICAgICAgICBxdWV1ZS5wdXNoKG5vZGUpXG4gICAgICAgICAgICAgICAgaGVscGVyRnVuY3Rpb24obm9kZSlcbiAgICAgICAgICAgICAgICBxdWV1ZS5zaGlmdCgpXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUubGVmdCkgcXVldWUucHVzaChub2RlLmxlZnQpXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUucmlnaHQpIHF1ZXVlLnB1c2gobm9kZS5yaWdodClcblxuICAgICAgICAgICAgICAgIC8vIGFsc28gdHJhdmVyc2UgZG93biB0aGUgY2hhaW5cbiAgICAgICAgICAgICAgICAvLyBnbyBsZWZ0PyBnbyByaWdodD9cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVjdXJzaXZlRnVuY3Rpb24oKVxuICAgICAgICAgICAgICAgIC8vIGRvIGkgbmVlZCB0byBoYXZlIHJlY3VyaXN2ZUZ1bmN0aW9uIHJldHVybiB0byB0aGUgcXVldWU/XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3JlY3Vyc2l2ZVxuICAgICAgICAgICAgLy8gbWF5IGhhdmUgdG8gc2V0IHJvb3QsIGFuZCBnZXQgdGhlIGNoaWxkcmVuXG4gICAgICAgICAgICAvLyBhZGQgdGhlIHZhbHVlIHRvIGEgcXVldWUsIHRha2UgaXQgb3V0LCBhbmQgdGhlbiBhZGQgdGhlIGNoaWxkcmVuIHRvIGEgcXVldWU/XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBsZXZlbE9yZGVySXRlcmF0aXZlKGhlbHBlckZ1bmN0aW9uKSB7XG4gICAgICAgIGxldCBxdWV1ZSA9IFtdXG4gICAgICAgIHF1ZXVlLnB1c2godGhpcy5yb290KVxuICAgICAgICB3aGlsZSAocXVldWUubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICBoZWxwZXJGdW5jdGlvbihxdWV1ZVswXSlcbiAgICAgICAgICAgIGlmIChxdWV1ZVswXS5sZWZ0KSBxdWV1ZS5wdXNoKHF1ZXVlWzBdLmxlZnQpXG4gICAgICAgICAgICBpZiAocXVldWVbMF0ucmlnaHQpIHF1ZXVlLnB1c2gocXVldWVbMF0ucmlnaHQpXG4gICAgICAgICAgICBxdWV1ZS5zaGlmdCgpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcmVPcmRlcihoZWxwZXJGdW5jdGlvbikge1xuICAgICAgICBpZiAoaGVscGVyRnVuY3Rpb24pIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICBoZWxwZXJGdW5jdGlvbihub2RlKVxuICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQgPT09IG51bGwgJiYgbm9kZS5yaWdodCA9PT0gbnVsbCkgcmV0dXJuXG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmxlZnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUubGVmdClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5yaWdodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5yaWdodClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlY3Vyc2l2ZUZ1bmN0aW9uKHRoaXMucm9vdClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVjdXJzaXZlVmFsdWUgPSBbbm9kZS5kYXRhXTtcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5sZWZ0ID09PSBudWxsICYmIG5vZGUucmlnaHQgPT09IG51bGwpIHJldHVybiBbbm9kZS5kYXRhXVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5sZWZ0KSByZWN1cnNpdmVWYWx1ZSA9IHJlY3Vyc2l2ZVZhbHVlLmNvbmNhdChyZWN1cnNpdmVGdW5jdGlvbihub2RlLmxlZnQpKVxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5yaWdodCkgcmVjdXJzaXZlVmFsdWUgPSByZWN1cnNpdmVWYWx1ZS5jb25jYXQocmVjdXJzaXZlRnVuY3Rpb24obm9kZS5yaWdodCkpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWN1cnNpdmVWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZWN1cnNpdmVGdW5jdGlvbih0aGlzLnJvb3QpKVxuXG4gICAgICAgICAgICAvLyBjbGVhbmVyIHZlcnNpb247IGJhc2UgY2FzZSBpcyBub3Qgc3RhdGVkLCBhcyBkbyBub3QgbmVlZCB0byBzdGF0ZSBpZiBudWxsXG4gICAgICAgICAgICAvLyBmdW5jdGlvbiByZWN1cnNpdmVUcmF2ZXJzYWwobm9kZSkge1xuICAgICAgICAgICAgLy8gbGV0IGFycmF5ID0gW25vZGUuZGF0YV0gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGlmIChub2RlLmxlZnQpIGFycmF5ID0gYXJyYXkuY29uY2F0KHJlY3Vyc2l2ZVRyYXZlcnNhbChub2RlLmxlZnQpKSAvLyBcImNvbm5lY3RpbmdcIiBhcnJheXNcbiAgICAgICAgICAgIC8vIGlmIChub2RlLnJpZ2h0KSBhcnJheSA9IGFycmF5LmNvbmNhdChyZWN1cnNpdmVUcmF2ZXJzYWwobm9kZS5yaWdodCkpIC8vIFwiY29ubmVjdGluZ1wiIGFycmF5c1xuICAgICAgICAgICAgLy8gcmV0dXJuIGFycmF5XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZWN1cnNpdmVUcmF2ZXJzYWwodGhpcy5yb290KSlcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGRvIHRoZSBzYW1lIGZvciBwcmVPcmRlciBhbmQgcG9zdE9yZGVyXG4gICAgaW5PcmRlcihoZWxwZXJGdW5jdGlvbikge1xuICAgICAgICBpZiAoaGVscGVyRnVuY3Rpb24pIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5sZWZ0ID09PSBudWxsICYmIG5vZGUucmlnaHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaGVscGVyRnVuY3Rpb24obm9kZSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUubGVmdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjdXJzaXZlRnVuY3Rpb24obm9kZS5sZWZ0KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGhlbHBlckZ1bmN0aW9uKG5vZGUpXG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnJpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWN1cnNpdmVGdW5jdGlvbihub2RlLnJpZ2h0KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVjdXJzaXZlRnVuY3Rpb24odGhpcy5yb290KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZnVuY3Rpb24gcmVjdXJzaXZlRnVuY3Rpb24obm9kZSkge1xuICAgICAgICAgICAgICAgIGxldCByZWN1cnNpdmVWYWx1ZSA9IFtub2RlLmRhdGFdOyAvLyBzb21laG93IGkgbmVlZCB0byByZXR1cm4gdGhlIGxlZnQgdHJlZXMsIGJlZm9yZSB0aGUgcmlnaHQgdHJlZXNcbiAgICAgICAgICAgICAgICBpZiAobm9kZS5sZWZ0ID09PSBudWxsICYmIG5vZGUucmlnaHQgPT09IG51bGwpIHJldHVybiBbbm9kZS5kYXRhXVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5sZWZ0KSByZWN1cnNpdmVWYWx1ZSA9IHJlY3Vyc2l2ZVZhbHVlLmNvbmNhdChyZWN1cnNpdmVGdW5jdGlvbihub2RlLmxlZnQpKVxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5yaWdodCkgcmVjdXJzaXZlVmFsdWUgPSByZWN1cnNpdmVWYWx1ZS5jb25jYXQocmVjdXJzaXZlRnVuY3Rpb24obm9kZS5yaWdodCkpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWN1cnNpdmVWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZWN1cnNpdmVGdW5jdGlvbih0aGlzLnJvb3QpKVxuICAgICAgICB9XG5cbiAgICB9XG5cblxuICAgIC8vIGhlaWdodDsgZmluZCBsb25nZXN0IGxlbmd0aCBiZXR3ZWVuIHRoaXMgbm9kZSwgYW5kIGxlYWYgbm9kZS4gaG93PyBkbyBpIG5lZWQgdG8gdXNlIGZpbmQ/XG4gICAgLy8gaGVpZ2h0KHZhbHVlKSB7XG4gICAgLy8gICAgIC8vZmlyc3QsIG5lZWQgdG8gZmluZCB0aGUgbm9kZVxuICAgIC8vICAgICAvLyB0aGVuLCBuZWVkIHRvIFxuICAgIC8vICAgICBmdW5jdGlvbiByZWN1cnNpdmVUcmF2ZXJzYWwoY3VycmVudE5vZGUsIHZhbHVlKSB7XG4gICAgLy8gICAgICAgICBpZiAoY3VycmVudE5vZGUgPSApXG5cbiAgICAvLyAgICAgfVxuICAgIC8vIH1cbn1cblxuXG5mdW5jdGlvbiBidWlsZFRyZWUoYXJyYXkpIHtcbiAgICAgICAgbGV0IHNvcnRlZEFycmF5ID0gbWVyZ2VTb3J0KGFycmF5KVxuICAgICAgICBsZXQgcmVtb3ZlZER1cGxpY2F0ZXMgPSBbLi4uIG5ldyBTZXQoc29ydGVkQXJyYXkpXVxuICAgICAgICByZXR1cm4gcmVjdXJzaXZlQnVpbGRUcmVlKHJlbW92ZWREdXBsaWNhdGVzKVxufVxuXG5mdW5jdGlvbiByZWN1cnNpdmVCdWlsZFRyZWUoYXJyYXkpIHtcbiAgICBpZiAoYXJyYXkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBudWxsOyAvLyB3aGF0IGRvIGkgbmVlZCB0byByZXR1cm4/IGFycmF5PyBub2RlP1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IG1pZGRsZUluZGV4ID0gTWF0aC5mbG9vcihhcnJheS5sZW5ndGgvMilcbiAgICAgICAgY29uc3Qgcm9vdCA9IG5ldyBOb2RlKGFycmF5W21pZGRsZUluZGV4XSlcblxuICAgICAgICByb290LmxlZnQgPSByZWN1cnNpdmVCdWlsZFRyZWUoYXJyYXkuc2xpY2UoMCwgbWlkZGxlSW5kZXgpKVxuICAgICAgICByb290LnJpZ2h0ID0gcmVjdXJzaXZlQnVpbGRUcmVlKGFycmF5LnNsaWNlKG1pZGRsZUluZGV4ICsgMSkpXG4gICAgICAgIHJldHVybiByb290O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gaW5zZXJ0KHZhbHVlKSB7XG4gICAgZnVuY3Rpb24gcmVjdXJzaXZlRnVuY3Rpb24obm9kZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIDwgbm9kZS5kYXRhICYmIG5vZGUubGVmdCA9PSBudWxsKSB7XG4gICAgICAgICAgICBjb25zdCBuZXdOb2RlID0gbmV3IE5vZGUodmFsdWUpO1xuICAgICAgICAgICAgbm9kZS5sZWZ0ID0gbmV3Tm9kZTtcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+IG5vZGUuZGF0YSAmJiBub2RlLnJpZ2h0ID09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnN0IG5ld05vZGUgPSBuZXcgTm9kZSh2YWx1ZSk7XG4gICAgICAgICAgICBub2RlLnJpZ2h0ID0gbmV3Tm9kZTtcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA8IG5vZGUuZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUubGVmdClcbiAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgbm9kZSwgbWFrZSBpdCB0aGUgY2hpbGQgb2YgdGhlIHByZXZpb3VzIG5vZGUsIGFuZCB0aGUgbmV3IHJvb3Qgb2YgdGhlIG5leHQgbm9kZXNcbiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+IG5vZGUuZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZUZ1bmN0aW9uKG5vZGUucmlnaHQpXG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT0gbm9kZS5kYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInZhbHVlIGFscmVhZHkgaW4gdHJlZSwgdHJ5IGFub3RoZXIgdmFsdWVcIilcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgfVxuICAgIHJlY3Vyc2l2ZUZ1bmN0aW9uKClcbn0iLCJleHBvcnQgY29uc3QgcHJldHR5UHJpbnQgPSAobm9kZSwgcHJlZml4ID0gXCJcIiwgaXNMZWZ0ID0gdHJ1ZSkgPT4ge1xuICBpZiAobm9kZSA9PT0gbnVsbCkge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAobm9kZS5yaWdodCAhPT0gbnVsbCkge1xuICAgIHByZXR0eVByaW50KG5vZGUucmlnaHQsIGAke3ByZWZpeH0ke2lzTGVmdCA/IFwi4pSCICAgXCIgOiBcIiAgICBcIn1gLCBmYWxzZSk7XG4gIH1cbiAgY29uc29sZS5sb2coYCR7cHJlZml4fSR7aXNMZWZ0ID8gXCLilJTilIDilIAgXCIgOiBcIuKUjOKUgOKUgCBcIn0ke25vZGUuZGF0YX1gKTtcbiAgaWYgKG5vZGUubGVmdCAhPT0gbnVsbCkge1xuICAgIHByZXR0eVByaW50KG5vZGUubGVmdCwgYCR7cHJlZml4fSR7aXNMZWZ0ID8gXCIgICAgXCIgOiBcIuKUgiAgIFwifWAsIHRydWUpO1xuICB9XG59OyIsIi8vIGltcG9ydCB7IE5vZGUsIFRyZWUsIGJ1aWxkVHJlZSB9IGZyb20gXCIuL2JpbmFyeVNlYXJjaFRyZWVcIjtcbmltcG9ydCB7IFRyZWUgfSBmcm9tIFwiLi9iaW5hcnlTZWFyY2hUcmVlXCI7XG5pbXBvcnQgeyBwcmV0dHlQcmludCB9IGZyb20gXCIuL3ByZXR0eVByaW50XCI7XG5cbmNvbnN0IHRlc3RBcnJheSA9IFsxLCA3LCA0LCAyMywgOCwgOSwgNCwgMywgNSwgNywgOSwgNjcsIDYzNDUsIDMyNF1cblxuXG4vLyBidWlsZFRyZWUodGVzdEFycmF5KVxubGV0IG5ld1RyZWUgPSBuZXcgVHJlZSh0ZXN0QXJyYXkpXG4vLyBwcmV0dHlQcmludChuZXdUcmVlLnJvb3QpXG5cbm5ld1RyZWUuaW5zZXJ0KDkpXG4vLyBwcmV0dHlQcmludChuZXdUcmVlLnJvb3QpXG5cbm5ld1RyZWUuZGVsZXRlKDMyMylcbnByZXR0eVByaW50KG5ld1RyZWUucm9vdClcblxubmV3VHJlZS5maW5kKDYpXG5uZXdUcmVlLmZpbmQoMSlcblxuLy8gbmV3VHJlZS5sZXZlbE9yZGVySXRlcmF0aXZlKChub2RlKSA9PiBjb25zb2xlLmxvZyhub2RlKSlcblxubmV3VHJlZS5pbk9yZGVyKClcblxubmV3VHJlZS5wcmVPcmRlcigobm9kZSk9PiBjb25zb2xlLmxvZyhub2RlLmRhdGEpKSJdLCJuYW1lcyI6WyJtZXJnZVNvcnQiLCJhcnJheSIsImxlbmd0aCIsImhhbGYiLCJNYXRoIiwiY2VpbCIsInNvcnRlZExlZnRIYWxmIiwic2xpY2UiLCJzb3J0ZWRSaWdodEhhbGYiLCJtZXJnZWRBcnJheSIsInB1c2giLCJzaGlmdCIsIk5vZGUiLCJjb25zdHJ1Y3RvciIsInZhbHVlIiwidGhpcyIsImRhdGEiLCJsZWZ0IiwicmlnaHQiLCJyZWN1cnNpdmVCdWlsZFRyZWUiLCJtaWRkbGVJbmRleCIsImZsb29yIiwicm9vdCIsInByZXR0eVByaW50Iiwibm9kZSIsInByZWZpeCIsImlzTGVmdCIsImNvbnNvbGUiLCJsb2ciLCJuZXdUcmVlIiwic29ydGVkQXJyYXkiLCJTZXQiLCJidWlsZFRyZWUiLCJpbnNlcnQiLCJyZWN1cnNpdmVGdW5jdGlvbiIsIm5ld05vZGUiLCJ0ZW1wIiwidGVtcFBhcmVudCIsImZpbmQiLCJsZXZlbE9yZGVyUmVjdXJzaXZlIiwiaGVscGVyRnVuY3Rpb24iLCJsZXZlbE9yZGVySXRlcmF0aXZlIiwicXVldWUiLCJwcmVPcmRlciIsInJlY3Vyc2l2ZVZhbHVlIiwiY29uY2F0IiwiaW5PcmRlciIsImRlbGV0ZSJdLCJzb3VyY2VSb290IjoiIn0=